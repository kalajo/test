import org.springframework.web.bind.annotation.*;
import org.springframework.http.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@RestController
@RequestMapping("/api")
public class QueryController {

    private static final Logger logger = LoggerFactory.getLogger(QueryController.class);
    private final QueryService queryService;

    public QueryController(QueryService queryService) {
        this.queryService = queryService;
    }

    @GetMapping(path = "/getQueryById", consumes = MediaType.APPLICATION_JSON_VALUE, produces = MediaType.APPLICATION_JSON_VALUE)
    @ResponseBody
    public ResponseEntity<?> getQueryById(@RequestParam("queryId") Long queryId) {
        // Sanitize the input
        if (queryId == null || queryId < 0) {
            return new ResponseEntity<>("Invalid queryId", HttpStatus.BAD_REQUEST);
        }

        logger.info("/getQueryById: {}", queryId);

        List<Query> queriesList = this.queryService.getQueryById(queryId);
        return new ResponseEntity<>(queriesList, HttpStatus.OK);
    }
}
